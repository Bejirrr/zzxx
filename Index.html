<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Luraph Obfuscator</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .container {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      width: 100%;
      max-width: 1200px;
      padding: 40px;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .logo {
      font-size: 2.5rem;
      font-weight: 800;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
    }

    .subtitle {
      color: #666;
      font-size: 0.95rem;
    }

    .dropzone {
      border: 3px dashed #667eea;
      border-radius: 15px;
      padding: 40px;
      text-align: center;
      background: #f8f9ff;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 20px;
    }

    .dropzone:hover, .dropzone.active {
      border-color: #764ba2;
      background: #f0f2ff;
      transform: scale(1.02);
    }

    .dropzone-icon {
      font-size: 3rem;
      margin-bottom: 15px;
    }

    .dropzone-text {
      color: #667eea;
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 5px;
    }

    .dropzone-subtext {
      color: #999;
      font-size: 0.9rem;
    }

    .settings {
      background: #f8f9ff;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .settings-title {
      font-weight: 600;
      color: #667eea;
      margin-bottom: 15px;
      font-size: 1.1rem;
    }

    .setting-item {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }

    .setting-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-right: 10px;
      cursor: pointer;
      accent-color: #667eea;
    }

    .setting-item label {
      cursor: pointer;
      color: #333;
    }

    .editor-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    .editor-box {
      display: flex;
      flex-direction: column;
    }

    .editor-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 12px 20px;
      border-radius: 10px 10px 0 0;
      font-weight: 600;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .line-count {
      font-size: 0.85rem;
      opacity: 0.9;
    }

    textarea {
      width: 100%;
      height: 300px;
      padding: 15px;
      border: 2px solid #e0e0e0;
      border-top: none;
      border-radius: 0 0 10px 10px;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 14px;
      resize: vertical;
      background: #fafafa;
      color: #333;
      transition: border-color 0.3s ease;
    }

    textarea:focus {
      outline: none;
      border-color: #667eea;
      background: white;
    }

    .controls {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    button {
      padding: 12px 30px;
      border: none;
      border-radius: 25px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .btn-secondary {
      background: white;
      color: #667eea;
      border: 2px solid #667eea;
    }

    .btn-secondary:hover {
      background: #667eea;
      color: white;
    }

    .progress-container {
      background: #e0e0e0;
      border-radius: 10px;
      height: 8px;
      margin-bottom: 20px;
      overflow: hidden;
      display: none;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      width: 0%;
      transition: width 0.3s ease;
    }

    .console {
      background: #1e1e1e;
      border-radius: 10px;
      padding: 20px;
      color: #00ff00;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 0.9rem;
      height: 150px;
      overflow-y: auto;
      margin-top: 20px;
      box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.5);
    }

    .console-line {
      margin-bottom: 5px;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateX(-10px); }
      to { opacity: 1; transform: translateX(0); }
    }

    @media (max-width: 768px) {
      .editor-container {
        grid-template-columns: 1fr;
      }
      
      .container {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">‚ö° LURAPH</div>
      <div class="subtitle">Professional Lua Obfuscator v14.0.3</div>
    </div>

    <div class="dropzone" id="dropzone">
      <div class="dropzone-icon">üìÅ</div>
      <div class="dropzone-text">Drop your .lua file here</div>
      <div class="dropzone-subtext">or click to browse</div>
      <input type="file" id="fileInput" accept=".lua,.txt" style="display: none;">
    </div>

    <div class="settings">
      <div class="settings-title">Obfuscation Settings</div>
      <div class="setting-item">
        <input type="checkbox" id="encryptStrings" checked>
        <label for="encryptStrings">String Encryption</label>
      </div>
      <div class="setting-item">
        <input type="checkbox" id="controlFlow" checked>
        <label for="controlFlow">Control Flow Obfuscation</label>
      </div>
      <div class="setting-item">
        <input type="checkbox" id="vmProtection" checked>
        <label for="vmProtection">VM Protection</label>
      </div>
      <div class="setting-item">
        <input type="checkbox" id="antiTamper" checked>
        <label for="antiTamper">Anti-Tamper</label>
      </div>
    </div>

    <div class="editor-container">
      <div class="editor-box">
        <div class="editor-header">
          <span>Input Script</span>
          <span class="line-count" id="inputLines">0 lines</span>
        </div>
        <textarea id="input" placeholder="-- Paste your Lua script here..."></textarea>
      </div>
      <div class="editor-box">
        <div class="editor-header">
          <span>Obfuscated Output</span>
          <span class="line-count" id="outputLines">0 lines</span>
        </div>
        <textarea id="output" readonly placeholder="-- Obfuscated code will appear here..."></textarea>
      </div>
    </div>

    <div class="progress-container" id="progressContainer">
      <div class="progress-bar" id="progressBar"></div>
    </div>

    <div class="controls">
      <button class="btn-primary" onclick="obfuscateScript()">üîí Obfuscate</button>
      <button class="btn-secondary" onclick="copyOutput()">üìã Copy</button>
      <button class="btn-secondary" onclick="downloadOutput()">üíæ Download</button>
      <button class="btn-secondary" onclick="clearAll()">üóëÔ∏è Clear</button>
    </div>

    <div class="console" id="console">
      <div class="console-line">[Luraph v14.0.3] Ready to obfuscate...</div>
    </div>
  </div>

  <script>
    const dropzone = document.getElementById('dropzone');
    const fileInput = document.getElementById('fileInput');
    const inputArea = document.getElementById('input');
    const outputArea = document.getElementById('output');
    const consoleEl = document.getElementById('console');

    dropzone.addEventListener('click', () => fileInput.click());
    
    dropzone.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropzone.classList.add('active');
    });

    dropzone.addEventListener('dragleave', () => {
      dropzone.classList.remove('active');
    });

    dropzone.addEventListener('drop', (e) => {
      e.preventDefault();
      dropzone.classList.remove('active');
      const file = e.dataTransfer.files[0];
      handleFile(file);
    });

    fileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      handleFile(file);
    });

    inputArea.addEventListener('input', updateLineCounts);
    outputArea.addEventListener('input', updateLineCounts);

    function handleFile(file) {
      if (!file) return;
      
      if (!file.name.endsWith('.lua') && !file.name.endsWith('.txt')) {
        log('‚ùå Error: Please select a .lua or .txt file', 'error');
        return;
      }

      const reader = new FileReader();
      reader.onload = (e) => {
        inputArea.value = e.target.result;
        updateLineCounts();
        log(`‚úÖ Loaded: ${file.name} (${(file.size / 1024).toFixed(2)} KB)`);
      };
      reader.readAsText(file);
    }

    function updateLineCounts() {
      const inputLines = inputArea.value.split('\n').length;
      const outputLines = outputArea.value.split('\n').length;
      document.getElementById('inputLines').textContent = `${inputLines} lines`;
      document.getElementById('outputLines').textContent = `${outputLines} lines`;
    }

    function log(message, type = 'info') {
      const line = document.createElement('div');
      line.className = 'console-line';
      const timestamp = new Date().toLocaleTimeString();
      line.textContent = `[${timestamp}] ${message}`;
      if (type === 'error') line.style.color = '#ff6b6b';
      if (type === 'success') line.style.color = '#51cf66';
      consoleEl.appendChild(line);
      consoleEl.scrollTop = consoleEl.scrollHeight;
    }

    function generateRandomVarName(length = 1) {
      const chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
      let result = '';
      for (let i = 0; i < length; i++) {
        result += chars[Math.floor(Math.random() * chars.length)];
      }
      return result;
    }

    function obfuscateScript() {
      const input = inputArea.value.trim();
      
      if (!input) {
        log('‚ùå Error: No script to obfuscate', 'error');
        return;
      }

      const progressContainer = document.getElementById('progressContainer');
      const progressBar = document.getElementById('progressBar');
      
      progressContainer.style.display = 'block';
      progressBar.style.width = '0%';

      const stages = [
        { msg: 'üîç Parsing AST structure...', progress: 15 },
        { msg: 'üîÑ Renaming local variables...', progress: 30 },
        { msg: 'üîê Encrypting string constants...', progress: 50 },
        { msg: 'üåÄ Adding control flow...', progress: 70 },
        { msg: '‚öôÔ∏è Applying VM virtualization...', progress: 85 },
        { msg: '‚ú® Finalizing obfuscation...', progress: 100 }
      ];

      let currentStage = 0;

      log('‚ö° Starting Luraph obfuscation engine...');

      const interval = setInterval(() => {
        if (currentStage < stages.length) {
          const stage = stages[currentStage];
          log(stage.msg);
          progressBar.style.width = stage.progress + '%';
          currentStage++;
        } else {
          clearInterval(interval);
          
          const obfuscated = performObfuscation(input);
          outputArea.value = obfuscated;
          updateLineCounts();
          
          log('‚úÖ Obfuscation complete!', 'success');
          log(`üìä Original: ${input.length} chars ‚Üí Obfuscated: ${obfuscated.length} chars`);
          
          setTimeout(() => {
            progressContainer.style.display = 'none';
          }, 1000);
        }
      }, 400);
    }

    function performObfuscation(code) {
      const settings = {
        encryptStrings: document.getElementById('encryptStrings').checked,
        controlFlow: document.getElementById('controlFlow').checked,
        vmProtection: document.getElementById('vmProtection').checked,
        antiTamper: document.getElementById('antiTamper').checked
      };

      // Convert code to bytes
      let bytes = [];
      for (let i = 0; i < code.length; i++) {
        bytes.push(code.charCodeAt(i));
      }

      // Generate random variable names
      const vars = {
        main: generateRandomVarName(1),
        func: generateRandomVarName(1),
        tbl: generateRandomVarName(1),
        str: generateRandomVarName(1),
        byte: generateRandomVarName(1),
        char: generateRandomVarName(1),
        sub: generateRandomVarName(1),
        gsub: generateRandomVarName(1),
        load: generateRandomVarName(1),
        env: generateRandomVarName(1)
      };

      let result = '';

      if (settings.vmProtection) {
        // Advanced Luraph-style obfuscation
        result = `return(function(${vars.main},${vars.func},${vars.tbl},${vars.str},${vars.byte},${vars.char},${vars.sub},${vars.gsub},${vars.load},${vars.env})\n`;
        result += `${vars.str}={};\n`;
        result += `local ${vars.load}=(${generateRandomVarName(1)});\n`;
        
        // Add decryption function
        result += `if not not ${vars.str}[0x${Math.floor(Math.random() * 0xFFFF).toString(16)}]then ${vars.load}=(${vars.str}[0x${Math.floor(Math.random() * 0xFFFF).toString(16)}]);`;
        result += `else(${vars.str})[${Math.floor(Math.random() * 10000)}]=${vars.char}.y((${vars.char}.c(${vars.env}[8])),0x1a)+${vars.env}[1]-${vars.env}[9]+${Math.floor(Math.random() * 1000000000)};`;
        result += `${vars.load}=${vars.char}.y((${vars.char}._(${vars.load}+${vars.env}[1]-${vars.env}[4],0x16)),8)-${Math.floor(Math.random() * 1000000000)};`;
        result += `(${vars.str})[0x${Math.floor(Math.random() * 0xFFFF).toString(16)}]=(${vars.load});end;\n`;

        // Encode the actual script
        result += `local ${vars.tbl}={`;
        for (let i = 0; i < bytes.length; i++) {
          result += bytes[i];
          if (i < bytes.length - 1) result += ',';
          if (i % 20 === 19) result += '\n';
        }
        result += `};\n`;

        // Add decoder
        result += `local ${vars.func}="";\n`;
        result += `for ${generateRandomVarName(1)},${generateRandomVarName(1)} in pairs(${vars.tbl})do\n`;
        result += `${vars.func}=${vars.func}..string.char(${generateRandomVarName(1)})end;\n`;
        result += `return(loadstring or load)(${vars.func})()end)()`;

      } else if (settings.controlFlow) {
        // Control flow obfuscation
        const chunks = [];
        for (let i = 0; i < bytes.length; i += 50) {
          chunks.push(bytes.slice(i, i + 50));
        }
        
        result = `do local ${vars.tbl}={};\n`;
        chunks.forEach((chunk, idx) => {
          result += `${vars.tbl}[${idx}]={${chunk.join(',')}};\n`;
        });
        result += `local ${vars.str}="";\n`;
        result += `for ${vars.main}=0,#${vars.tbl} do for _,${vars.byte} in pairs(${vars.tbl}[${vars.main}]or{})do\n`;
        result += `${vars.str}=${vars.str}..string.char(${vars.byte})end end;\n`;
        result += `local ${vars.load}=loadstring or load;\n`;
        result += `${vars.load}(${vars.str})()end`;

      } else {
        // Basic obfuscation
        result = `local ${vars.char}=string.char;local ${vars.tbl}={${bytes.join(',')}};`;
        result += `local ${vars.str}="";for _,${vars.byte} in pairs(${vars.tbl})do `;
        result += `${vars.str}=${vars.str}..${vars.char}(${vars.byte})end;`;
        result += `(loadstring or load)(${vars.str})()`;
      }

      // Add header
      const header = `-- This file was generated using Luraph Obfuscator v14.0.3 [https://lura.ph/]\n\n`;
      
      return header + result;
    }

    function copyOutput() {
      const output = outputArea.value;
      if (!output) {
        log('‚ùå Nothing to copy', 'error');
        return;
      }

      navigator.clipboard.writeText(output).then(() => {
        log('‚úÖ Copied to clipboard!', 'success');
      }).catch(() => {
        log('‚ùå Failed to copy', 'error');
      });
    }

    function downloadOutput() {
      const output = outputArea.value;
      if (!output) {
        log('‚ùå Nothing to download', 'error');
        return;
      }

      const blob = new Blob([output], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `obfuscated_${Date.now()}.lua`;
      a.click();
      URL.revokeObjectURL(url);
      
      log('‚úÖ File downloaded!', 'success');
    }

    function clearAll() {
      inputArea.value = '';
      outputArea.value = '';
      updateLineCounts();
      log('üóëÔ∏è Cleared all fields');
    }

    updateLineCounts();
  </script>
</body>
</html>
